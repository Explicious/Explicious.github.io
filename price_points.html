<!DOCTYPE html>
<html lang = "en">
    <head>
        <script src = "https://d3js.org/d3.v4.min.js"></script>
        <link rel="stylesheet" type="text/css" href="index.css" /> 
    </head>

    <body onload="data_init()">
        <h1 class="test">Price of Wine vs. Point Value Given</h1>
        <svg width=1000 height=1000> </svg>
        <script>
            console.log("hi");
            async function data_init () {
                var data = await d3.csv("/winemag-data-130k-v2.csv");
                var agg_data = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                const aggregate = (value) => {
                    if(typeof(value) !== "number"){
                        return;
                    }
                    switch (Math.floor(value/10)) {
                        case 0:
                            agg_data[0]++;
                            break;
                        case 1:
                            agg_data[1]++;
                            break;
                        case 2:
                            agg_data[2]++;
                            break;
                        case 3:
                            agg_data[3]++;
                            break;
                        case 4:
                            agg_data[4]++;
                            break;
                        case 5:
                            agg_data[5]++;
                            break;
                        case 6:
                            agg_data[6]++;
                            break;
                        case 7:
                            agg_data[7]++;
                            break;
                        case 8:
                            agg_data[8]++;
                            break;
                        case 9:
                            agg_data[9]++;
                            break;
                        case 10:
                            agg_data[9]++;
                            break;
                    }
                    data.forEach(aggregate);
                    console.log(agg_data);
                    console.log("hello");
                    d3.select("svg").selectAll("rect").data(agg_data).enter().append("rect").attr("x", function(d, i) {return (i+1)*80}).attr("y",function(d, i) {return 800-Math.floor(d/100)}).attr("height",function(d, i) {return Math.floor(d/100);}).attr("width",80);
                };
                
            }
            
            
        </script>
</html>